<script src="https://unpkg.com/imask"></script>
<script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@10.2.7/dist/autoComplete.min.js"></script>
<script>
    // const autoCompleteJS = new autoComplete({
    //     placeHolder: "Search for Food...",
    //     name : autoCompleteJS,
    //     src : ["Moscow","Elista","Ahty","Baku","Stambul","France"]
    // })
    const autoCompleteJS = new autoComplete({
  data: {
    src: async () => {
      try {
        // Loading placeholder text
        document
          .getElementById("autoComplete")
          .setAttribute("placeholder", "Loading...");
        // Fetch External Data Source
        const source = await fetch(
          "https://tarekraafat.github.io/autoComplete.js/demo/db/generic.json"
        );
        const data = await source.json();
        // Post Loading placeholder text
        document
          .getElementById("autoComplete")
          .setAttribute("placeholder", autoCompleteJS.placeHolder);
        // Returns Fetched data
        return data;
      } catch (error) {
        return error;
      }
    },
    keys: ["food", "cities", "animals"],
    cache: true,
    filter: (list) => {
      // Filter duplicates
      // incase of multiple data keys usage
      const filteredResults = Array.from(
        new Set(list.map((value) => value.match))
      ).map((food) => {
        return list.find((value) => value.match === food);
      });

      return filteredResults;
    }
  },
  placeHolder: "Search for Food & Drinks!",
  resultsList: {
    element: (list, data) => {
      const info = document.createElement("p");
      if (data.results.length > 0) {
        info.innerHTML = `Displaying <strong>${data.results.length}</strong> out of <strong>${data.matches.length}</strong> results`;
      } else {
        info.innerHTML = `Found <strong>${data.matches.length}</strong> matching results for <strong>"${data.query}"</strong>`;
      }
      list.prepend(info);
    },
    noResults: true,
    maxResults: 15,
    tabSelect: true
  },
  resultItem: {
    element: (item, data) => {
      // Modify Results Item Style
      item.style = "display: flex; justify-content: space-between;";
      // Modify Results Item Content
      item.innerHTML = `
      <span style="text-overflow: ellipsis; white-space: nowrap; overflow: hidden;">
        ${data.match}
      </span>
      <span style="display: flex; align-items: center; font-size: 13px; font-weight: 100; text-transform: uppercase; color: rgba(0,0,0,.2);">
        ${data.key}
      </span>`;
    },
    highlight: true
  },
  events: {
    input: {
      focus: () => {
        if (autoCompleteJS.input.value.length) autoCompleteJS.start();
      }
    }
  }
});

// autoCompleteJS.input.addEventListener("init", function (event) {
//   console.log(event);
// });

// autoCompleteJS.input.addEventListener("response", function (event) {
//   console.log(event.detail);
// });

// autoCompleteJS.input.addEventListener("results", function (event) {
//   console.log(event.detail);
// });

// autoCompleteJS.input.addEventListener("open", function (event) {
//   console.log(event.detail);
// });

// autoCompleteJS.input.addEventListener("navigate", function (event) {
//   console.log(event.detail);
// });

autoCompleteJS.input.addEventListener("selection", function (event) {
  const feedback = event.detail;
  autoCompleteJS.input.blur();
  // Prepare User's Selected Value
  const selection = feedback.selection.value[feedback.selection.key];
  // Render selected choice to selection div
  document.querySelector(".selection").innerHTML = selection;
  // Replace Input value with the selected value
  autoCompleteJS.input.value = selection;
  // Console log autoComplete data feedback
  console.log(feedback);
});

// autoCompleteJS.input.addEventListener("close", function (event) {
//   console.log(event.detail);
// });

// Toggle Search Engine Type/Mode
document.querySelector(".toggler").addEventListener("click", () => {
  // Holds the toggle button selection/alignment
  const toggle = document.querySelector(".toggle").style.justifyContent;

  if (toggle === "flex-start" || toggle === "") {
    // Set Search Engine mode to Loose
    document.querySelector(".toggle").style.justifyContent = "flex-end";
    document.querySelector(".toggler").innerHTML = "Loose";
    autoCompleteJS.searchEngine = "loose";
  } else {
    // Set Search Engine mode to Strict
    document.querySelector(".toggle").style.justifyContent = "flex-start";
    document.querySelector(".toggler").innerHTML = "Strict";
    autoCompleteJS.searchEngine = "strict";
  }
});

// Blur/unBlur page elements
const action = (action) => {
  const title = document.querySelector("h1");
  const mode = document.querySelector(".mode");
  const selection = document.querySelector(".selection");
  const footer = document.querySelector(".footer");

  if (action === "dim") {
    title.style.opacity = 1;
    mode.style.opacity = 1;
    selection.style.opacity = 1;
  } else {
    title.style.opacity = 0.3;
    mode.style.opacity = 0.2;
    selection.style.opacity = 0.1;
  }
};

// Blur/unBlur page elements on input focus
["focus", "blur"].forEach((eventType) => {
  autoCompleteJS.input.addEventListener(eventType, () => {
    // Blur page elements
    if (eventType === "blur") {
      action("dim");
    } else if (eventType === "focus") {
      // unBlur page elements
      action("light");
    }
  });
});
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@10.2.7/dist/css/autoComplete.min.css">
<h1>Регистрация</h1>
<form action="">
    <div><label for="userName"> Имя</label><input type="text" name="userName" id="userName" value="Вадим"></div>
    <div><label for="login"> Логин</label><input type="text" name="login" id="login" value="Vadem45454" required></div>
    <div><label for="email"> Почта</label><input type="email" name="email" id="email" value="vadim.sardarov@yandex.ru" required></div>
    <div><label for="dateOfBirth"> Дата рождения</label><input type="date" name="dateOfBirth" value="2002-05-26" id="dateOfBirth" checked></div>
    <div><label for="phoneNumber"> Номер телефона</label><input type="text" name="phoneNumber" value="9772596770"  id="phone-mask" required>
    </div>
    <div><label for="password"> Введите пароль</label><input type="password" name="password" id="password" required>
    </div>
    <div><label for="passwordRewrite"> Введите пароль</label><input type="password" name="passwordRewrite"
            id="passwordRewrite" required></div>
    <div><label for="avatar"> Аватар профиля</label><input type="file" name="avatar" id="avatar"></div>
    <div class="autoComplete_wrapper">
        <input id="autoComplete" type="text" tabindex="1">
      </div>
    <div><label for="persData">Согласие на обработку персональных данных</label><input type="checkbox" name="persData" id="persData" required></div>
    <div><label for="mailing"> Согласие на рассылку персональных предложений по указанному адресу почты</label><input type="checkbox" name="mailing" id="mailing" checked></div>
    <button type="submit" onclick="return checkPassword(this)">Отправить</button>
</form>

<style>
    :root {
  --transition-1: all 0.3s ease-in-out;
  --transition-2: all 0.2s ease-in-out;
}
    input:valid {
        border: 2px solid green;

    }

    input {
        margin-bottom: 10px;
    }

    label {
        margin-right: 10px;
    }
</style>

<script>
    var phoneMask = IMask(
        document.getElementById('phone-mask'), {
        mask: '+{7}(000)000-00-00'
    });

    function checkPassword(form) {
        debugger;
        password1 = document.querySelector("input[name ='password']").value;
        password2 = document.querySelector("input[name ='passwordRewrite']").value;

        // If password not entered
        if (password1 == '')
            alert("Пожалуйста, введите пароль");
        // If confirm password not entered
        else if (password2 == '')
            alert("Пожалуйста, подтвердите ваш пароль");

        // If Not same return False.
        else if (password1 != password2) {
            alert(" Пиздиш")
            return false;
        }

        // If same return True.
        else {
            alert("Не пиздиш")
            return true;
        }

    }


</script>